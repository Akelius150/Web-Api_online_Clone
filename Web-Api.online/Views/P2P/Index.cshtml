@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager
@{
    ViewData["Title"] = "P2P";
}

@model P2PViewModel

<div class="text-center">
    <h1 class="display-4">P2P</h1>
</div>

<div class="container" style="margin-top: 20px">
    <div class="row" style="margin-bottom: 10px;">
        <button type="button" id="addP2PButton" class="btn btn-outline-primary" data-toggle="modal" data-target="#exampleModalCenter">Add P2P Ad</button>
    </div>
    <ul class="nav nav-tabs nav-bordered">
        <input type="checkbox" id="switch1" checked data-switch="bool"/>
        <label for="switch1" data-on-label="Buy" data-off-label="Sell" style="margin-top: 14px;"></label>
        @foreach (var crypt in Model.Crypts)
        {
            <li class="nav-item">
                <a href="@($"/p2p/{crypt.Name}/1")" aria-expanded="false" class="nav-link active py-2" style="background-color: #fafbfe;">
                    @crypt.Name
                </a>
            </li>
        }
    </ul>
    <form class="row gy-2 gx-2 align-items-center justify-content-xl-start justify-content-between" style="margin-top: 10px">
        <div class="col-auto">
            <label for="inputPassword2">Amount</label>
            <input type="search" class="form-control" id="inputPassword2" placeholder="Enter amount...">
        </div>
        <div class="col-auto">
            <div class="align-items-center">
                <label for="status-select" class="me-2">Fiat</label>
                <select class="form-select" id="status-select">
                </select>
            </div>
        </div>
        <div class="col-auto">
            <div class="align-items-center">
                <label for="status-select" class="me-2">Payment</label>
                <select class="form-select" id="status-select">
                    <option selected="">All payments</option>
                </select>
            </div>
        </div>
        <div class="col-auto">
            <div class="align-items-right">
                <label for="status-select" class="me-2">Payment</label>
                <select class="form-select" id="status-select">
                    <option selected="">All payments</option>
                </select>
            </div>
        </div>
    </form>
    <div class="row" style="margin-top:10px">
        <table class="table table-hover table-centered mb-0">
            <thead>
            <tr>
                <th>Advertisers</th>
                <th>Price<span class="badge badge-warning-lighten">lowest to highest</span></th>
                <th>Limit/Available</th>
                <th>Payment</th>
                <th>Trade<span class="badge badge-success-lighten">0 Fee</span></th>
            </tr>
            </thead>
            <tbody>
            @foreach (var seller in Model.P2PSellers)
            {
                <tr>
                    <td>@seller.UserName</td>
                    <td>@seller.Price @seller.FiatName</td>
                    <td>
                        <div class="row">
                            <span>Available: @seller.Available</span>
                        </div>
                        <div class="row">
                            <span>Limit: @seller.Available</span>
                        </div>
                    </td>
                    <td>
                        @foreach (var payment in seller.Payments)
                        {
                            <span class="badge badge-dark-lighten">payment.Name</span>
                        }
                    </td>
                    <td>
                        <button type="button" class="btn btn-success">Buy USDT</button>
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="border-radius: 100px !important;">
            <div class="modal-body" style="padding: 0rem !important;">
                <div class="card">
                    <div class="card-body p-3">
                        <div class="row">
                            <div class="col-xl-12">
                                <div class="mb-1 text-center">
                                    <h4>Create P2P Ad</h4>
                                </div>
                                <hr>
                                <div class="mb-3">
                                    <div class="row">
                                        <div class="middle d-flex">
                                            <div class="col-6">
                                                <label>
                                                    <input type="radio" name="radio" checked/>
                                                    <div class="front-end box">
                                                        <span>Buy</span>
                                                    </div>
                                                </label>
                                            </div>
                                            <div class="col-6">
                                                <label>
                                                    <input type="radio" name="radio"/>
                                                    <div class="back-end box">
                                                        <span>Sell</span>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-1 d-flex">
                                    <div class="col-6">
                                        <label class="form-label">Asset</label>
                                        <select class="form-select mb-3">
                                        </select>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">With Fiat</label>
                                        <select class="form-select mb-3">
                                        </select>
                                    </div>
                                </div>
                                <div class="mb-3 form-margins">
                                    <label class="form-label">Price</label>
                                    <input data-toggle="touchspin" class="form-control" type="text" value="0">
                                </div>
                                <div class="mb-4 form-margins">
                                    <label class="form-label">Total amount</label>
                                    <div class="input-group flex-nowrap">
                                        <input type="text" class="form-control" placeholder="Enter total trading quantity">
                                        <span class="input-group-text" id="basic-addon1">USDT</span>
                                    </div>
                                </div>
                                <div class="mb-1 d-flex">
                                    <div class="col-6">
                                        <label class="form-label">Payment Method</label>
                                        <label class="form-label" style="color: #b3b3b3">Select 5 methods</label>
                                    </div>
                                    <div class="col-6 text-sm-end mt-1">
                                        <button type="button" class="btn btn-primary btn-modal-style">+ Add</button>
                                    </div>
                                </div>
                                <div class="mb-3 form-margins">
                                    <label class="form-label">Payment Time Limit</label>
                                    <select class="form-select mb-3">
                                        <option selected>15 mins</option>
                                        <option>30 mins</option>
                                        <option>45 mins</option>
                                        <option>1 hr</option>
                                        <option>2 hrs</option>
                                    </select>
                                </div>
                                <hr>
                                <div class="mb-1 text-center d-flex">
                                    <div class="col-6">
                                        <button class="btn btn-light" data-dismiss="modal">Close</button>
                                    </div>
                                    <div class="col-6">
                                        <button class="btn btn-primary" type="submit">Create</button>
                                    </div>
                                </div>
                            </div> <!-- end col-->
                        </div><!-- end row -->
                    </div> <!-- end card-body -->
                </div> <!-- end card-->
            </div>

        </div>
    </div>
</div>

<style>
    .input-group-text {
        background-color: white !important;
    }

    .form-margins {
        margin-left: 15px;
        margin-right: 15px;
    }
    .bootstrap-touchspin-down, .bootstrap-touchspin-up, .btn-modal-style {
        background: white;  
        border-color: #dee2e6;
        box-shadow: 0px 0px 0px 0px rgb(114 124 245 / 50%) !important;
        color: #6c757d;
    }
    .middle {
      width: 100%;
      text-align: center;
      /* Made by */
    }
    .box {
        border-width: thin;
        border-color: #dee2e6;
        border-style: solid;
        border-radius: 5px;
    }
    .middle h1 {
      color: white;
    }
    .middle input[type=radio] {
      display: none;
    }
    .middle input[type=radio]:checked + .box {
      background-color: white;
    }
    .middle input[type=radio]:checked + .box span {
      color: #6c747c;
    }
    .middle input[type=radio]:checked + .box span:before {
      opacity: 1;
    }
    .middle .box {
      width: 179px;
      height: 37.5px;
      background-color: #808080;
      transition: all 250ms ease;
      will-change: transition;
      display: inline-block;
      text-align: center;
      cursor: pointer;
      position: relative;
      font-weight: 900;
    }
    .middle .box span {
      position: absolute;
      left: 0;
      right: 0;
      transition: all 300ms ease;
      font-size: 14.4px;
      user-select: none;
      color: #4d4d4d;
    }
    .middle .front-end span {
      margin-top: 7px;
    }
    .middle .back-end span {
      margin-top: 7px;
    }
    .middle p {
      color: white;
      font-weight: 400;
    }
    .middle p a {
      text-decoration: underline;
      color: #fff;
    }
    .middle p span:after {
      content: "\f0e7";
      color: yellow;
    }
</style>

<script>
    $(document).ready(function() {       
        
        if (window.location.href.includes("sell")){
            $('#switch1').prop('checked', false);
        }
        else
        {
            $('#switch1').prop('checked', true);
        }
        
        $('#switch1').change(function() {
            if(this.checked) {
                window.location.replace(window.location.href.split('/')[0] + "/p2p/buy/USDT/1")
            }  
            else
            {
                window.location.replace(window.location.href.split('/')[0] + "/p2p/sell/USDT/1")
            }
        });
    });
</script>